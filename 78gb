local Notification = loadstring(game:HttpGet("https://raw.githubusercontent.com/Qing-Yun-Dev/UI/Main/Notification.lua"))()

function Notify(Text)
    Notification:ForceNotify({Name = "by:codm656558 | Guts & Blackpower", Text = Text, Icon = "rbxassetid://11401835376", Duration = 5})
end

if game:GetService("UserInputService").KeyboardEnabled and game:GetService("UserInputService").MouseEnabled then
    Notify("F5 Hide UI")
elseif game:GetService("UserInputService").TouchEnabled then
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Qing-Yun-Dev/UI/Main/Open.lua"))()
end

local UI = loadstring(game:HttpGet("https://raw.githubusercontent.com/Qing-Yun-Dev/UI/Main/Vape.lua"))()

local Win = UI:Window("by:codm656558 | Guts & Blackpower | æ³¨å…¥å™¨ : "..identifyexecutor(), Color3.fromRGB(44, 120, 224))

local Tab = Win:Tab("ä¸»è¦")

-- è¾…åŠ©å‡½æ•°ï¼šè·å–ç©å®¶å½“å‰æ­¦å™¨
local function GetGun()
    local character = game.Players.LocalPlayer.Character
    if character then
        for _, child in pairs(character:GetChildren()) do
            if child:GetAttribute("IsGun") then
                return child
            end
        end
    end
    local backpack = game.Players.LocalPlayer.Backpack
    if backpack then
        for _, child in pairs(backpack:GetChildren()) do
            if child:GetAttribute("IsGun") then
                return child
            end
        end
    end
    return nil
end

-- å¢™ä½“æ£€æµ‹å‡½æ•°ï¼ˆä¼˜åŒ–ç‰ˆï¼‰
local wallCheckEnabled = false
local Player = game.Players.LocalPlayer

local function isBehindWall(targetPart, origin)
    if not wallCheckEnabled then return false end
    
    -- æ’é™¤Buildingsæ–‡ä»¶å¤¹å†…çš„å»ºç­‘
    local raycastParams = RaycastParams.new()
    raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
    local filterList = {Player.Character, targetPart.Parent}
    
    -- æ·»åŠ Buildingsæ–‡ä»¶å¤¹åˆ°é»‘åå•ï¼Œä½¿å…¶å¯ç©¿é€
    local buildingsFolder = workspace:FindFirstChild("Buildings")
    if buildingsFolder then
        for _, building in ipairs(buildingsFolder:GetDescendants()) do
            if building:IsA("BasePart") then
                table.insert(filterList, building)
            end
        end
    end
    
    raycastParams.FilterDescendantsInstances = filterList
    
    local direction = (targetPart.Position - origin).Unit
    local distance = (targetPart.Position - origin).Magnitude
    local raycastResult = workspace:Raycast(origin, direction * distance, raycastParams)
    
    return raycastResult ~= nil
end

-- è‡ªåŠ¨å°„å‡»BarrelåŠŸèƒ½ï¼ˆä¼˜åŒ–ç‰ˆï¼Œä¿®å¤å¡é¡¿ï¼‰
local AutoShootBarrel = false
local AutoShootBarrelThread = nil
local BarrelShootDistance = 10 -- å…¶ä»–ç©å®¶é è¿‘Barrelçš„è·ç¦»
local WallCheck = false -- å¢™ä½“æ£€æµ‹å¼€å…³
local RangeCircle = false -- èŒƒå›´åœˆå¼€å…³
local RangeCircleRadius = 10 -- èŒƒå›´åœˆåŠå¾„
local RangeCirclePart = nil -- èŒƒå›´åœˆå¯è§†åŒ–éƒ¨åˆ†
local AutoShootFrequency = 0.8 -- è‡ªåŠ¨å°„å‡»æ£€æµ‹é¢‘ç‡ï¼Œé»˜è®¤0.8ç§’
local lastFrequencyValue = 8 -- ä¸Šä¸€æ¬¡çš„é¢‘ç‡æ˜¾ç¤ºå€¼
local lastDistanceValue = 10 -- ä¸Šä¸€æ¬¡çš„è·ç¦»æ˜¾ç¤ºå€¼
local lastCircleValue = 10 -- ä¸Šä¸€æ¬¡çš„èŒƒå›´åœˆæ˜¾ç¤ºå€¼

-- åˆ›å»ºèŒƒå›´åœˆå¯è§†åŒ–ï¼ˆåœ†å½¢ï¼‰
local function CreateRangeCircle()
    if RangeCirclePart then
        RangeCirclePart:Destroy()
    end
    
    RangeCirclePart = Instance.new("Part")
    RangeCirclePart.Shape = Enum.PartType.Cylinder
    RangeCirclePart.Size = Vector3.new(0.1, RangeCircleRadius * 2, RangeCircleRadius * 2)
    RangeCirclePart.Transparency = 0.7
    RangeCirclePart.Color = Color3.fromRGB(0, 255, 0)
    RangeCirclePart.Material = Enum.Material.Neon
    RangeCirclePart.Anchored = true
    RangeCirclePart.CanCollide = false
    RangeCirclePart.Parent = workspace
end

-- æ›´æ–°èŒƒå›´åœˆä½ç½®
local function UpdateRangeCircle()
    if RangeCircle and RangeCirclePart then
        local character = game.Players.LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            RangeCirclePart.Position = character.HumanoidRootPart.Position
            RangeCirclePart.CFrame = CFrame.new(character.HumanoidRootPart.Position) * CFrame.Angles(0, 0, math.rad(90))
        end
    end
end

-- æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–ç©å®¶é è¿‘Barrelï¼ˆä¼˜åŒ–ç‰ˆï¼Œä½¿ç”¨å¯è°ƒèŠ‚é¢‘ç‡ï¼‰
local function CheckBarrelsForAutoShoot()
    if not AutoShootBarrel then return nil end
    
    local gun = GetGun()
    if not gun or gun.ShotsLoaded.Value <= 0 then return nil end
    
    local foundBarrel = nil
    local closestDistance = math.huge
    
    -- æŸ¥æ‰¾æ‰€æœ‰Barrel
    for _, barrel in ipairs(workspace:GetDescendants()) do
        if barrel.Name == "Agent" and barrel:GetAttribute("Type") == "Barrel" and barrel:FindFirstChild("HumanoidRootPart") then
            -- æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–ç©å®¶é è¿‘
            for _, player in ipairs(game.Players:GetPlayers()) do
                if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("Humanoid") then
                    local humanoid = player.Character.Humanoid
                    if humanoid.Health > 0 and player.Character:FindFirstChild("HumanoidRootPart") then
                        local distance = (player.Character.HumanoidRootPart.Position - barrel.HumanoidRootPart.Position).Magnitude
                        
                        -- æ£€æŸ¥æ˜¯å¦åœ¨èŒƒå›´å†…
                        if distance <= BarrelShootDistance then
                            -- æ£€æŸ¥æ˜¯å¦åœ¨èŒƒå›´åœˆå†…ï¼ˆå¦‚æœå¼€å¯äº†èŒƒå›´åœˆï¼‰
                            if RangeCircle then
                                local myPos = game.Players.LocalPlayer.Character.HumanoidRootPart.Position
                                local barrelPos = barrel.HumanoidRootPart.Position
                                local distanceToBarrel = (myPos - barrelPos).Magnitude
                                
                                if distanceToBarrel <= RangeCircleRadius then
                                    -- å¢™ä½“æ£€æµ‹ï¼ˆå¦‚æœå¼€å¯ï¼‰
                                    if WallCheck then
                                        local origin = Player.Character.Head.Position
                                        if not isBehindWall(barrel.HumanoidRootPart, origin) then
                                            if distance < closestDistance then
                                                closestDistance = distance
                                                foundBarrel = barrel
                                            end
                                        end
                                    else
                                        if distance < closestDistance then
                                            closestDistance = distance
                                            foundBarrel = barrel
                                        end
                                    end
                                end
                            else
                                -- å¢™ä½“æ£€æµ‹ï¼ˆå¦‚æœå¼€å¯ï¼‰
                                if WallCheck then
                                    local origin = Player.Character.Head.Position
                                    if not isBehindWall(barrel.HumanoidRootPart, origin) then
                                        if distance < closestDistance then
                                            closestDistance = distance
                                            foundBarrel = barrel
                                        end
                                    end
                                else
                                    if distance < closestDistance then
                                        closestDistance = distance
                                        foundBarrel = barrel
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    
    return foundBarrel
end

-- è‡ªåŠ¨å°„å‡»æ–¹æ¡ˆï¼šæƒ…äº‘æ–¹æ¡ˆ
local AutoShootMode = 1 -- åªä¿ç•™æƒ…äº‘æ–¹æ¡ˆ
local AutoShootToggle

-- åˆ›å»ºè‡ªåŠ¨å°„å‡»Toggle
local function CreateAutoShootToggle()
    AutoShootToggle = Tab:Toggle("è‡ªåŠ¨é»‘æª", false, function(Value)
        if Value then
            AutoShootMode = 1
            Notify("å¯ç”¨è‡ªåŠ¨é»‘æª(æ²¡è‡ªçˆ†çš„åœ°æ–¹å»ºè®®å…³æ‰ğŸ¤«)")
        end
    end)
end

-- åˆå§‹åŒ–è‡ªåŠ¨å°„å‡»Toggle
CreateAutoShootToggle()

-- å¯åŠ¨è‡ªåŠ¨å°„å‡»ï¼ˆä¼˜åŒ–ç‰ˆï¼Œä¿®å¤å¡é¡¿ï¼‰
Tab:Toggle("å¯ç”¨è‡ªåŠ¨é»‘æª", false, function(Value)
    AutoShootBarrel = Value
    
    if Value then
        Notify("è‡ªåŠ¨é»‘æªå·²å¯ç”¨")
        
        -- åˆ›å»ºèŒƒå›´åœˆï¼ˆå¦‚æœéœ€è¦ï¼‰
        if RangeCircle then
            CreateRangeCircle()
        end
        
        -- å¯åŠ¨è‡ªåŠ¨å°„å‡»çº¿ç¨‹ï¼ˆä½¿ç”¨å¯è°ƒèŠ‚é¢‘ç‡ï¼‰
        AutoShootBarrelThread = task.spawn(function()
            while AutoShootBarrel do
                -- ä½¿ç”¨å¯è°ƒèŠ‚é¢‘ç‡
                task.wait(AutoShootFrequency)
                
                -- æ›´æ–°èŒƒå›´åœˆä½ç½®
                if RangeCircle then
                    UpdateRangeCircle()
                end
                
                -- æ£€æµ‹æ˜¯å¦æœ‰ç¬¦åˆæ¡ä»¶çš„Barrel
                local barrel = CheckBarrelsForAutoShoot()
                if barrel then
                    -- æ‰§è¡Œå°„å‡»ï¼ˆåªå°„å‡»ä¸€æ¬¡ï¼‰
                    local gun = GetGun()
                    if gun and gun.ShotsLoaded.Value > 0 then
                        local Velocity = barrel.HumanoidRootPart.Velocity
                        local Magnitude = Velocity.Magnitude * 0.3
                        
                        if Magnitude > 0 then
                            gun.RemoteEvent:FireServer("Fire", game.Players.LocalPlayer.Character.Model, 
                                barrel.HumanoidRootPart.Position + Velocity.Unit * Magnitude, workspace:GetServerTimeNow())
                        else
                            gun.RemoteEvent:FireServer("Fire", game.Players.LocalPlayer.Character.Model, 
                                barrel.HumanoidRootPart.Position, workspace:GetServerTimeNow())
                        end
                        
                        -- å¦‚æœå°„å‡»æˆåŠŸä¸”å­å¼¹ä¸º0ï¼Œè‡ªåŠ¨æ¢å¼¹
                        if gun.ShotsLoaded.Value == 0 then
                            task.wait(0.1)
                            gun.RemoteEvent:FireServer("Reload")
                        end
                    end
                end
            end
        end)
    else
        -- åœæ­¢è‡ªåŠ¨å°„å‡»çº¿ç¨‹
        if AutoShootBarrelThread then
            task.cancel(AutoShootBarrelThread)
            AutoShootBarrelThread = nil
        end
        
        -- æ¸…ç†èŒƒå›´åœˆ
        if RangeCirclePart then
            RangeCirclePart:Destroy()
            RangeCirclePart = nil
        end
        
        Notify("è‡ªåŠ¨é»‘æªå·²ç¦ç”¨")
    end
end)

-- è‡ªåŠ¨å°„å‡»æ£€æµ‹é¢‘ç‡è°ƒèŠ‚ï¼ˆä¿®æ”¹æ˜¾ç¤ºé€»è¾‘ï¼šæ˜¾ç¤º1å¯¹åº”0.1ï¼Œæ˜¾ç¤º8å¯¹åº”0.8ï¼‰
Tab:Slider("è‡ªåŠ¨é»‘æªæ£€æµ‹é¢‘ç‡(é™¤å¤–10å°±æ˜¯å®é™…æ•°å­—.è¶Šä½è¶Šå¡ä½†ç§’å‘å°„ï¼Œè¿˜æœ‰åå‡ å¸§ï¼Œèƒ½ç©)", 1, 10, 8, function(Value)
    -- è½¬æ¢ä¸ºå®é™…é¢‘ç‡ï¼šæ˜¾ç¤ºå€¼/10
    local actualFrequency = Value / 10
    
    -- åªæœ‰å½“å€¼æ”¹å˜æ—¶æ‰æ˜¾ç¤ºæç¤º
    if Value ~= lastFrequencyValue then
        AutoShootFrequency = actualFrequency
        Notify("è‡ªåŠ¨é»‘æªæ£€æµ‹é¢‘ç‡è®¾ç½®ä¸º: " .. Value .. " (å®é™…" .. string.format("%.1f", actualFrequency) .. "ç§’)")
        lastFrequencyValue = Value
    end
end)

-- æ·»åŠ è·ç¦»æ»‘åŠ¨æ¨¡å—ï¼ˆä¿®æ”¹æ˜¾ç¤ºé€»è¾‘ï¼šæ˜¾ç¤º3å¯¹åº”å®é™…1ï¼Œæ˜¾ç¤º9å¯¹åº”å®é™…3ï¼‰
Tab:Slider("é˜Ÿå‹é è¿‘Barrelè·ç¦»(é™¤3å°±æ˜¯å®é™…æ•°å­—ï¼Œè½®æ¤…è„šæœ¬çˆ±ç”¨ä¸ç”¨)", 3, 150, 30, function(Value)
    -- è½¬æ¢ä¸ºå®é™…è·ç¦»ï¼šæ˜¾ç¤ºå€¼/3
    local actualDistance = Value / 3
    
    -- åªæœ‰å½“å€¼æ”¹å˜æ—¶æ‰æ˜¾ç¤ºæç¤º
    if Value ~= lastDistanceValue then
        BarrelShootDistance = actualDistance
        Notify("é˜Ÿå‹é è¿‘Barrelè·ç¦»è®¾ç½®ä¸º: " .. Value .. " studs (å®é™…" .. string.format("%.1f", actualDistance) .. " studs)")
        lastDistanceValue = Value
    end
end)

-- èŒƒå›´åœˆå¤§å°è°ƒèŠ‚ï¼ˆä¿®æ”¹æ˜¾ç¤ºé€»è¾‘ï¼šæ˜¾ç¤º3å¯¹åº”å®é™…1ï¼Œæ˜¾ç¤º9å¯¹åº”å®é™…3ï¼‰
Tab:Slider("èŒƒå›´åœˆå¤§å°(é™¤3)", 15, 450, 30, function(Value)
    -- è½¬æ¢ä¸ºå®é™…åŠå¾„ï¼šæ˜¾ç¤ºå€¼/3
    local actualRadius = Value / 3
    
    -- åªæœ‰å½“å€¼æ”¹å˜æ—¶æ‰æ˜¾ç¤ºæç¤º
    if Value ~= lastCircleValue then
        RangeCircleRadius = actualRadius
        Notify("èŒƒå›´åœˆå¤§å°è®¾ç½®ä¸º: " .. Value .. " studs (å®é™…" .. string.format("%.1f", actualRadius) .. " studs)")
        lastCircleValue = Value
        
        -- æ›´æ–°èŒƒå›´åœˆå¤§å°
        if RangeCirclePart then
            RangeCirclePart.Size = Vector3.new(0.1, RangeCircleRadius * 2, RangeCircleRadius * 2)
        end
    end
end)

-- å¢™ä½“æ£€æµ‹å¼€å…³
Tab:Toggle("å¢™ä½“æ£€æµ‹(78æ£€æµ‹ï¼Œå¼€äº†ç”¨ä¸äº†è‡ªåŠ¨é»‘æª)", false, function(Value)
    WallCheck = Value
    wallCheckEnabled = Value
    Notify("å¢™ä½“æ£€æµ‹: " .. (Value and "å¼€å¯" or "å…³é—­"))
end)

-- èŒƒå›´åœˆå¼€å…³
Tab:Toggle("èŒƒå›´åœˆæ˜¾ç¤º", false, function(Value)
    RangeCircle = Value
    if Value then
        CreateRangeCircle()
        Notify("èŒƒå›´åœˆå·²æ˜¾ç¤º")
    else
        if RangeCirclePart then
            RangeCirclePart:Destroy()
            RangeCirclePart = nil
        end
        Notify("èŒƒå›´åœˆå·²éšè—")
    end
end)

-- è‡ªåŠ¨æ¢å¼¹æ–¹æ¡ˆ2
local AutoReloadV2Enabled = false
local AutoReloadV2Connection = nil

Tab:Toggle("è‡ªåŠ¨æ¢å¼¹", false, function(Value)
    AutoReloadV2Enabled = Value
    if Value then
        AutoReloadV2Connection = game:GetService("RunService").RenderStepped:Connect(function()
            if not AutoReloadV2Enabled then return end
            
            local gun = GetGun()
            if gun then
                gun.RemoteEvent:FireServer("Reload")
            end
        end)
        Notify("å¯ç”¨è‡ªåŠ¨æ¢å¼¹")
    else
        if AutoReloadV2Connection then
            AutoReloadV2Connection:Disconnect()
            AutoReloadV2Connection = nil
        end
        Notify("ç¦ç”¨è‡ªåŠ¨æ¢å¼¹")
    end
end)

Tab:Toggle("Silent Aim", false, function(Value)
    if Value then
        OriginalNamecall = hookmetamethod(game, "__namecall", newcclosure(function(self, ...)
            local args = {...}
            if args[1] == "Fire" then
                task.spawn(function()
                    for _, v in ipairs(workspace:GetDescendants()) do
                        if v.Name == "HeadlessHorseman" or v.Name == "Dracula" or (v.Name == "Agent" and v:GetAttribute("Type") == "Barrel") then
                            local TargetVelocity = v.HumanoidRootPart.Velocity
                            local Distance = TargetVelocity.Magnitude * 0.3
                            if Distance > 0 then
                                local Direction = TargetVelocity.Unit
                                local PredictedPosition = v.HumanoidRootPart.Position + (Direction * Distance)
                                args[3] = PredictedPosition
                            else
                                args[3] = v.HumanoidRootPart.Position
                            end
                            return OriginalNamecall(self, unpack(args))
                        end
                    end
                end)
            end
            return OriginalNamecall(self, unpack(args))
        end))
    else
        if OriginalNamecall then
            hookmetamethod(game, "__namecall", OriginalNamecall)
        end
    end
end)

local Tab = Win:Tab("ESP")

local function ESP(inst, color, size, text, Highlight)
    if Highlight then
        local Highlight = Instance.new("Highlight")
        Highlight.Parent = inst
        Highlight.FillColor = color
        Highlight.FillTransparency = 0.50
        Highlight.Name = "QYHighlight"
        game:GetService("TweenService"):Create(
            Highlight,
            TweenInfo.new(1),
            {
                OutlineTransparency = Highlight.OutlineTransparency
            }
        ):Play()
    end

    local BillboardGui = Instance.new("BillboardGui")
    BillboardGui.AlwaysOnTop = true
    BillboardGui.Parent = inst
    BillboardGui.Size = size
    BillboardGui.StudsOffset = Vector3.new(0, 1, 0)
    BillboardGui.Name = "QY"

    local TextLabel = Instance.new("TextLabel")
    TextLabel.Text = text
    TextLabel.Font = Enum.Font.SourceSans
    TextLabel.FontSize = Enum.FontSize.Size24
    TextLabel.TextColor3 = color
    TextLabel.BackgroundTransparency = 1
    TextLabel.Size = size
    TextLabel.Parent = BillboardGui
    TextLabel.Name = "QY"
    TextLabel.TextStrokeTransparency = 0
    TextLabel.TextStrokeColor3 = Color3.new(1, 1, 1)

    return Highlight, BillboardGui
end

-- ç‹¬ç«‹é€è§†åŠŸèƒ½å˜é‡
local visionConnections = {}
local zombieHighlights = {}
local draculaHighlight = nil
local headlessHorsemanHighlight = nil

-- åƒµå°¸ç±»å‹é…ç½®ï¼ˆç‹¬ç«‹å¼€å…³ï¼‰
local ZOMBIE_TYPES = {
    ["Axe"] = {
        name = "Za",
        color = Color3.fromRGB(180, 0, 250), -- ç´«è‰²
        enabled = false,
        highlightColor = Color3.fromRGB(180, 0, 250)
    },
    ["Eye"] = {
        name = "Ru", 
        color = Color3.fromRGB(255, 50, 50), -- çº¢è‰²
        enabled = false,
        highlightColor = Color3.fromRGB(255, 50, 50)
    },
    ["Sword"] = {
        name = "Cu",
        color = Color3.fromRGB(456,13,56), -- æ·±çº¢è‰²
        enabled = false,
        highlightColor = Color3.fromRGB(456,13,56)
    },
    ["Barrel"] = {
        name = "Ba",
        color = Color3.fromRGB(250, 250, 0), -- é»„è‰²
        enabled = false,
        highlightColor = Color3.fromRGB(250, 250, 0)
    },
    ["FTorso"] = {
        name = "Li",
        color = Color3.fromRGB(255, 120, 0), -- æ©™è‰²
        enabled = false,
        highlightColor = Color3.fromRGB(255, 120, 0)
    }
}

-- å¾·å¤æ‹‰é…ç½®
local DRACULA_CONFIG = {
    name = "å¾·å¤æ‹‰",
    color = Color3.fromRGB(43, 255, 0), -- ç»¿è‰²
    enabled = false,
    highlightColor = Color3.fromRGB(43, 255, 0)
}

-- æ— å¤´éª‘å£«é…ç½®  
local HEADLESS_HORSEMAN_CONFIG = {
    name = "æ— å¤´éª‘å£«",
    color = Color3.fromRGB(255, 0, 0), -- çº¢è‰²
    enabled = false,
    highlightColor = Color3.fromRGB(255, 0, 0)
}

-- æŸ¥æ‰¾åƒµå°¸
local function findZombies()
    local zombies = {}
    local cameraFolder = workspace:FindFirstChild("Camera")
    
    if cameraFolder then
        for _, model in pairs(cameraFolder:GetChildren()) do
            if model:IsA("Model") and model.Name:find("Zombie") then
                table.insert(zombies, model)
            end
        end
    end
    
    return zombies
end

local function findDracula()
    local transylvania = workspace:FindFirstChild("Transylvania")
    if not transylvania then return nil end
    
    local modes = transylvania:FindFirstChild("Modes")
    if not modes then return nil end
    
    local boss = modes:FindFirstChild("Boss")
    if not boss then return nil end
    
    return boss:FindFirstChild("Dracula")
end

local function findHeadlessHorseman()
    for _, model in pairs(workspace:GetChildren()) do
        if model:IsA("Model") and model.Name == "HeadlessHorseman" then
            return model
        end
    end
    return nil
end

-- æ£€æŸ¥åƒµå°¸æ˜¯å¦åŒ¹é…å¼€å¯çš„é€è§†ç±»å‹
local function shouldHighlightZombie(zombie)
    for partName, config in pairs(ZOMBIE_TYPES) do
        if config.enabled and zombie:FindFirstChild(partName) then
            return config
        end
    end
    return nil
end

-- åˆ›å»ºåƒµå°¸é«˜äº®
local function createZombieHighlight(zombie, zombieConfig)
    if zombieHighlights[zombie] then
        return -- å·²ç»å­˜åœ¨é«˜äº®ï¼Œä¸é‡å¤åˆ›å»º
    end
    
    local attachPart = zombie.PrimaryPart or zombie:FindFirstChild("Head") or zombie:FindFirstChild("HumanoidRootPart")
    if not attachPart then return end
    
    -- åˆ›å»ºé«˜äº®ï¼ˆæƒ…äº‘é£æ ¼ï¼‰
    local highlight = Instance.new("Highlight")
    highlight.Name = "QYHighlight"
    highlight.FillColor = zombieConfig.highlightColor
    highlight.FillTransparency = 0.5
    highlight.OutlineTransparency = 0
    highlight.Parent = attachPart
    
    -- åˆ›å»ºBillboardGuiï¼ˆæƒ…äº‘é£æ ¼ï¼Œæ›´å°çš„å°ºå¯¸ï¼‰
    local BillboardGui = Instance.new("BillboardGui")
    BillboardGui.AlwaysOnTop = true
    BillboardGui.Parent = attachPart
    BillboardGui.Size = UDim2.new(0, 80, 0, 30) -- æ›´å°çš„å°ºå¯¸
    BillboardGui.StudsOffset = Vector3.new(0, 2, 0)
    BillboardGui.Name = "QY"

    local TextLabel = Instance.new("TextLabel")
    TextLabel.Text = zombieConfig.name
    TextLabel.Font = Enum.Font.SourceSans
    TextLabel.FontSize = Enum.FontSize.Size18 -- æ›´å°çš„å­—ä½“
    TextLabel.TextColor3 = zombieConfig.highlightColor
    TextLabel.BackgroundTransparency = 1
    TextLabel.Size = UDim2.new(1, 0, 1, 0)
    TextLabel.Parent = BillboardGui
    TextLabel.Name = "QY"
    TextLabel.TextStrokeTransparency = 0
    TextLabel.TextStrokeColor3 = Color3.new(1, 1, 1)
    
    zombieHighlights[zombie] = {highlight = highlight, billboard = BillboardGui}
end

-- åˆ›å»ºå¾·å¤æ‹‰é«˜äº®
local function createDraculaHighlight(dracula)
    if draculaHighlight then
        return -- å·²ç»å­˜åœ¨ï¼Œä¸é‡å¤åˆ›å»º
    end
    
    local attachPart = dracula.PrimaryPart or dracula:FindFirstChild("Head") or dracula:FindFirstChild("HumanoidRootPart")
    if not attachPart then return end
    
    -- åˆ›å»ºé«˜äº®ï¼ˆæƒ…äº‘é£æ ¼ï¼‰
    local highlight = Instance.new("Highlight")
    highlight.Name = "QYHighlight"
    highlight.FillColor = DRACULA_CONFIG.highlightColor
    highlight.FillTransparency = 0.4
    highlight.OutlineTransparency = 0
    highlight.Parent = attachPart
    
    -- åˆ›å»ºBillboardGuiï¼ˆæƒ…äº‘é£æ ¼ï¼Œæ›´å°çš„å°ºå¯¸ï¼‰
    local BillboardGui = Instance.new("BillboardGui")
    BillboardGui.AlwaysOnTop = true
    BillboardGui.Parent = attachPart
    BillboardGui.Size = UDim2.new(0, 100, 0, 35) -- æ›´å°çš„å°ºå¯¸
    BillboardGui.StudsOffset = Vector3.new(0, 2.5, 0)
    BillboardGui.Name = "QY"

    local TextLabel = Instance.new("TextLabel")
    TextLabel.Text = DRACULA_CONFIG.name
    TextLabel.Font = Enum.Font.SourceSans
    TextLabel.FontSize = Enum.FontSize.Size20 -- æ›´å°çš„å­—ä½“
    TextLabel.TextColor3 = DRACULA_CONFIG.highlightColor
    TextLabel.BackgroundTransparency = 1
    TextLabel.Size = UDim2.new(1, 0, 1, 0)
    TextLabel.Parent = BillboardGui
    TextLabel.Name = "QY"
    TextLabel.TextStrokeTransparency = 0
    TextLabel.TextStrokeColor3 = Color3.new(1, 1, 1)
    
    draculaHighlight = {highlight = highlight, billboard = BillboardGui}
end

-- åˆ›å»ºæ— å¤´éª‘å£«é«˜äº®
local function createHeadlessHorsemanHighlight(horseman)
    if headlessHorsemanHighlight then
        return -- å·²ç»å­˜åœ¨ï¼Œä¸é‡å¤åˆ›å»º
    end
    
    local attachPart = horseman.PrimaryPart or horseman:FindFirstChild("HumanoidRootPart")
    if not attachPart then return end
    
    -- åˆ›å»ºé«˜äº®ï¼ˆæƒ…äº‘é£æ ¼ï¼‰
    local highlight = Instance.new("Highlight")
    highlight.Name = "QYHighlight"
    highlight.FillColor = HEADLESS_HORSEMAN_CONFIG.highlightColor
    highlight.FillTransparency = 0.4
    highlight.OutlineTransparency = 0
    highlight.Parent = attachPart
    
    -- åˆ›å»ºBillboardGuiï¼ˆæƒ…äº‘é£æ ¼ï¼Œæ›´å°çš„å°ºå¯¸ï¼‰
    local BillboardGui = Instance.new("BillboardGui")
    BillboardGui.AlwaysOnTop = true
    BillboardGui.Parent = attachPart
    BillboardGui.Size = UDim2.new(0, 90, 0, 30) -- æ›´å°çš„å°ºå¯¸
    BillboardGui.StudsOffset = Vector3.new(0, 2.5, 0)
    BillboardGui.Name = "QY"

    local TextLabel = Instance.new("TextLabel")
    TextLabel.Text = HEADLESS_HORSEMAN_CONFIG.name
    TextLabel.Font = Enum.Font.SourceSans
    TextLabel.FontSize = Enum.FontSize.Size18 -- æ›´å°çš„å­—ä½“
    TextLabel.TextColor3 = HEADLESS_HORSEMAN_CONFIG.highlightColor
    TextLabel.BackgroundTransparency = 1
    TextLabel.Size = UDim2.new(1, 0, 1, 0)
    TextLabel.Parent = BillboardGui
    TextLabel.Name = "QY"
    TextLabel.TextStrokeTransparency = 0
    TextLabel.TextStrokeColor3 = Color3.new(1, 1, 1)
    
    headlessHorsemanHighlight = {highlight = highlight, billboard = BillboardGui}
end

-- æ¸…ç†åƒµå°¸é«˜äº®
local function clearZombieHighlights()
    for zombie, highlightData in pairs(zombieHighlights) do
        if highlightData.highlight and highlightData.highlight.Parent then
            highlightData.highlight:Destroy()
        end
        if highlightData.billboard and highlightData.billboard.Parent then
            highlightData.billboard:Destroy()
        end
    end
    zombieHighlights = {}
    
    if draculaHighlight then
        if draculaHighlight.highlight then draculaHighlight.highlight:Destroy() end
        if draculaHighlight.billboard then draculaHighlight.billboard:Destroy() end
        draculaHighlight = nil
    end
    
    if headlessHorsemanHighlight then
        if headlessHorsemanHighlight.highlight then headlessHorsemanHighlight.highlight:Destroy() end
        if headlessHorsemanHighlight.billboard then headlessHorsemanHighlight.billboard:Destroy() end
        headlessHorsemanHighlight = nil
    end
end

-- æ›´æ–°åƒµå°¸é«˜äº®
local function updateZombieHighlights()
    -- æ¸…ç†ä¸å­˜åœ¨çš„åƒµå°¸é«˜äº®
    local toRemove = {}
    for zombie, _ in pairs(zombieHighlights) do
        if not zombie.Parent then
            toRemove[zombie] = true
        end
    end
    for zombie in pairs(toRemove) do
        if zombieHighlights[zombie] then
            if zombieHighlights[zombie].highlight then zombieHighlights[zombie].highlight:Destroy() end
            if zombieHighlights[zombie].billboard then zombieHighlights[zombie].billboard:Destroy() end
        end
        zombieHighlights[zombie] = nil
    end
    
    -- æ›´æ–°æ™®é€šåƒµå°¸é«˜äº®
    local zombies = findZombies()
    for _, zombie in pairs(zombies) do
        local zombieConfig = shouldHighlightZombie(zombie)
        if zombieConfig then
            if not zombieHighlights[zombie] then
                createZombieHighlight(zombie, zombieConfig)
            end
        else
            -- å¦‚æœåƒµå°¸ä¸åº”è¯¥è¢«é«˜äº®ï¼Œä½†ä¹‹å‰æœ‰é«˜äº®ï¼Œåˆ™æ¸…é™¤
            if zombieHighlights[zombie] then
                if zombieHighlights[zombie].highlight then zombieHighlights[zombie].highlight:Destroy() end
                if zombieHighlights[zombie].billboard then zombieHighlights[zombie].billboard:Destroy() end
                zombieHighlights[zombie] = nil
            end
        end
    end
    
    -- æ›´æ–°å¾·å¤æ‹‰é«˜äº®
    if DRACULA_CONFIG.enabled then
        local dracula = findDracula()
        if dracula then
            if not draculaHighlight then
                createDraculaHighlight(dracula)
            end
        else
            if draculaHighlight then
                if draculaHighlight.highlight then draculaHighlight.highlight:Destroy() end
                if draculaHighlight.billboard then draculaHighlight.billboard:Destroy() end
                draculaHighlight = nil
            end
        end
    else
        if draculaHighlight then
            if draculaHighlight.highlight then draculaHighlight.highlight:Destroy() end
            if draculaHighlight.billboard then draculaHighlight.billboard:Destroy() end
            draculaHighlight = nil
        end
    end
    
    -- æ›´æ–°æ— å¤´éª‘å£«é«˜äº®
    if HEADLESS_HORSEMAN_CONFIG.enabled then
        local headlessHorseman = findHeadlessHorseman()
        if headlessHorseman then
            if not headlessHorsemanHighlight then
                createHeadlessHorsemanHighlight(headlessHorseman)
            end
        else
            if headlessHorsemanHighlight then
                if headlessHorsemanHighlight.highlight then headlessHorsemanHighlight.highlight:Destroy() end
                if headlessHorsemanHighlight.billboard then headlessHorsemanHighlight.billboard:Destroy() end
                headlessHorsemanHighlight = nil
            end
        end
    else
        if headlessHorsemanHighlight then
            if headlessHorsemanHighlight.highlight then headlessHorsemanHighlight.highlight:Destroy() end
            if headlessHorsemanHighlight.billboard then headlessHorsemanHighlight.billboard:Destroy() end
            headlessHorsemanHighlight = nil
        end
    end
end

-- å¯ç”¨é€è§†åŠŸèƒ½
local function enableVision(zombieType)
    if visionConnections[zombieType] then return end
    
    -- å¯åŠ¨æ›´æ–°å¾ªç¯
    visionConnections[zombieType] = game:GetService("RunService").Heartbeat:Connect(function()
        -- æ£€æŸ¥æ˜¯å¦è¿˜æœ‰ä»»ä½•åƒµå°¸ç±»å‹è¢«å¯ç”¨
        local anyEnabled = false
        for _, config in pairs(ZOMBIE_TYPES) do
            if config.enabled then
                anyEnabled = true
                break
            end
        end
        
        if DRACULA_CONFIG.enabled or HEADLESS_HORSEMAN_CONFIG.enabled then
            anyEnabled = true
        end
        
        if not anyEnabled then
            -- å¦‚æœæ²¡æœ‰ç±»å‹è¢«å¯ç”¨ï¼Œæ–­å¼€æ‰€æœ‰è¿æ¥
            for typeName, connection in pairs(visionConnections) do
                connection:Disconnect()
                visionConnections[typeName] = nil
            end
            clearZombieHighlights()
            return
        end
        
        updateZombieHighlights()
    end)
    
    -- åˆå§‹æ›´æ–°
    updateZombieHighlights()
end

-- ç¦ç”¨é€è§†åŠŸèƒ½
local function disableVision(zombieType)
    if visionConnections[zombieType] then
        visionConnections[zombieType]:Disconnect()
        visionConnections[zombieType] = nil
    end
    
    -- æ¸…ç†å¯¹åº”ç±»å‹çš„é«˜äº®
    for zombie, highlightData in pairs(zombieHighlights) do
        local zombieConfig = shouldHighlightZombie(zombie)
        if not zombieConfig then
            if highlightData.highlight then highlightData.highlight:Destroy() end
            if highlightData.billboard then highlightData.billboard:Destroy() end
            zombieHighlights[zombie] = nil
        end
    end
    
    -- å¦‚æœæ²¡æœ‰ç±»å‹è¢«å¯ç”¨ï¼Œæ–­å¼€æ‰€æœ‰è¿æ¥
    local anyEnabled = false
    for _, config in pairs(ZOMBIE_TYPES) do
        if config.enabled then
            anyEnabled = true
            break
        end
    end
    
    if DRACULA_CONFIG.enabled or HEADLESS_HORSEMAN_CONFIG.enabled then
        anyEnabled = true
    end
    
    if not anyEnabled then
        for typeName, connection in pairs(visionConnections) do
            connection:Disconnect()
            visionConnections[typeName] = nil
        end
        clearZombieHighlights()
    end
end

-- åŸESPåŠŸèƒ½
Tab:Toggle("Bomber ESP", false, function(Value)
    if Value then
        BomberESP = workspace.Zombies.DescendantAdded:Connect(function(inst)
            if inst.Name == "Agent" and inst:GetAttribute("Type") == "Barrel" then
                local BillboardGui = ESP(inst, Color3.new(1, 0, 0), UDim2.new(0, 80, 0, 30), "Bomber") -- æ”¹å°å°ºå¯¸
            end
        end)
        for _, v in ipairs(workspace.Zombies:GetDescendants()) do
            if v.Name == "Agent" and v:GetAttribute("Type") == "Barrel" then
                local BillboardGui = ESP(v, Color3.new(1, 0, 0), UDim2.new(0, 80, 0, 30), "Bomber") -- æ”¹å°å°ºå¯¸
            end
        end
    else
        if BomberESP then
            BomberESP:Disconnect()
        end
        for _, v in ipairs(workspace.Zombies:GetDescendants()) do
            if v.Name == "Agent" and v:GetAttribute("Type") == "Barrel" then
                if v:FindFirstChild("QY") then
                    v.QY:Destroy()
                end
            end
        end
    end
end)

-- ç‹¬ç«‹åƒµå°¸é€è§†å¼€å…³
Tab:Toggle("å¤§å¸ˆå…„é€è§†", false, function(Value)
    ZOMBIE_TYPES["Axe"].enabled = Value
    Notify("å¤§å¸ˆå…„é€è§†: " .. (Value and "å¼€å¯" or "å…³é—­"))
    
    if Value then
        enableVision("Axe")
    else
        disableVision("Axe")
    end
end)

Tab:Toggle("çº¢çœ¼é€è§†", false, function(Value)
    ZOMBIE_TYPES["Eye"].enabled = Value
    Notify("çº¢çœ¼é€è§†: " .. (Value and "å¼€å¯" or "å…³é—­"))
    
    if Value then
        enableVision("Eye")
    else
        disableVision("Eye")
    end
end)

Tab:Toggle("èƒ¸ç”²åƒµå°¸é€è§†", false, function(Value)
    ZOMBIE_TYPES["Sword"].enabled = Value
    Notify("èƒ¸ç”²åƒµå°¸é€è§†: " .. (Value and "å¼€å¯" or "å…³é—­"))
    
    if Value then
        enableVision("Sword")
    else
        disableVision("Sword")
    end
end)

Tab:Toggle("è‡ªçˆ†é€è§†", false, function(Value)
    ZOMBIE_TYPES["Barrel"].enabled = Value
    Notify("è‡ªçˆ†é€è§†: " .. (Value and "å¼€å¯" or "å…³é—­"))
    
    if Value then
        enableVision("Barrel")
    else
        disableVision("Barrel")
    end
end)

Tab:Toggle("ç«å“¥é€è§†", false, function(Value)
    ZOMBIE_TYPES["FTorso"].enabled = Value
    Notify("ç«å“¥é€è§†: " .. (Value and "å¼€å¯" or "å…³é—­"))
    
    if Value then
        enableVision("FTorso")
    else
        disableVision("FTorso")
    end
end)

Tab:Toggle("å¾·å¤æ‹‰é€è§†", false, function(Value)
    DRACULA_CONFIG.enabled = Value
    Notify("å¾·å¤æ‹‰é€è§†: " .. (Value and "å¼€å¯" or "å…³é—­"))
    
    if Value then
        enableVision("Dracula")
    else
        disableVision("Dracula")
    end
end)

Tab:Toggle("æ— å¤´éª‘å£«é€è§†", false, function(Value)
    HEADLESS_HORSEMAN_CONFIG.enabled = Value
    Notify("æ— å¤´éª‘å£«é€è§†: " .. (Value and "å¼€å¯" or "å…³é—­"))
    
    if Value then
        enableVision("HeadlessHorseman")
    else
        disableVision("HeadlessHorseman")
    end
end)

-- åˆ›å»ºæ–°çš„"æ‚é¡¹å®ç”¨åŠŸèƒ½"åˆ†åŒº
local UtilityTab = Win:Tab("æ‚é¡¹å®ç”¨åŠŸèƒ½")

-- å¤§å¤´å¨ƒå¨ƒåŠŸèƒ½
local bigHeadEnabled = false
local bigHeadConnection = nil
local originalProperties = {}

local function processBigHead()
    local camera = workspace:FindFirstChild("Camera")
    if not camera then return end
    
    for _, zombie in ipairs(camera:GetDescendants()) do
        if zombie.Name == "m_Zombie" and zombie:FindFirstChild("Head") then
            local head = zombie.Head
            if bigHeadEnabled then
                if not originalProperties[zombie] then
                    originalProperties[zombie] = {
                        Size = head.Size,
                        Transparency = head.Transparency
                    }
                end
                head.Size = Vector3.new(4, 4, 4)
                head.Transparency = 0.5
            else
                if originalProperties[zombie] then
                    head.Size = originalProperties[zombie].Size
                    head.Transparency = originalProperties[zombie].Transparency
                end
            end
        end
    end
end

UtilityTab:Toggle("å¤§å¤´åƒµå°¸", false, function(Value)
    bigHeadEnabled = Value
    Notify("å¤§å¤´åƒµå°¸: " .. (Value and "å¼€å¯" or "å…³é—­"))
    
    if Value then
        -- å¼€å¯å¤§å¤´å¨ƒå¨ƒ
        processBigHead()
        bigHeadConnection = workspace.Camera.DescendantAdded:Connect(function(descendant)
            if descendant.Name == "m_Zombie" and descendant:FindFirstChild("Head") then
                if bigHeadEnabled then
                    task.wait(0.1)
                    local head = descendant.Head
                    originalProperties[descendant] = {
                        Size = head.Size,
                        Transparency = head.Transparency
                    }
                    head.Size = Vector3.new(4, 4, 4)
                    head.Transparency = 0.5
                end
            end
        end)
    else
        -- å…³é—­å¤§å¤´å¨ƒå¨ƒ
        processBigHead()
        table.clear(originalProperties)
        
        if bigHeadConnection then
            bigHeadConnection:Disconnect()
            bigHeadConnection = nil
        end
    end
end)

-- ç§»é™¤æ‘”ä¼¤åŠŸèƒ½
local noFallDamageEnabled = false
local fallDamageConnection = nil

local function preventFallDamage()
    while noFallDamageEnabled do
        task.wait(2) -- é™ä½æ£€æµ‹é¢‘ç‡
        if not game.Players.LocalPlayer.Character then continue end
        
        local health = game.Players.LocalPlayer.Character:FindFirstChild("Health")
        if not health then continue end
        
        local forceSelfDamage = health:FindFirstChild("ForceSelfDamage")
        if not forceSelfDamage then continue end
        
        local args = {0}
        pcall(function()
            forceSelfDamage:FireServer(unpack(args))
        end)
    end
end

UtilityTab:Toggle("ç§»é™¤æ‘”ä¼¤", false, function(Value)
    noFallDamageEnabled = Value
    Notify("ç§»é™¤æ‘”ä¼¤: " .. (Value and "å¼€å¯" or "å…³é—­"))
    
    if Value then
        -- å¼€å¯ç§»é™¤æ‘”ä¼¤
        fallDamageConnection = task.spawn(preventFallDamage)
    else
        -- å…³é—­ç§»é™¤æ‘”ä¼¤
        if fallDamageConnection then
            task.cancel(fallDamageConnection)
            fallDamageConnection = nil
        end
    end
end)

local Tab = Win:Tab("æœ¬åœ°ç©å®¶")

local Speed = 0
local JumpPower = 30

Tab:Toggle("æ— é™è·³(å…ˆæ‰“å¼€ä¿®æ”¹è·³è·ƒ)", false, function(Value)
    if Value then
        InfiniteJump = game:GetService("UserInputService").JumpRequest:Connect(function()
            game.Players.LocalPlayer.Character.Humanoid:ChangeState("Jumping")
        end)
    else
        if InfiniteJump then
            InfiniteJump:Disconnect()
        end
    end
end)

Tab:Toggle("ä¿®æ”¹é€Ÿåº¦", false, function(Value)
    if Value then
        EnableSpeed = game:GetService("RunService").Heartbeat:Connect(function()
            if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
                game.Players.LocalPlayer.Character:TranslateBy(game.Players.LocalPlayer.Character.Humanoid.MoveDirection * Speed / 10)
            end
        end)
    else
        if EnableSpeed then
            EnableSpeed:Disconnect()
        end
    end
end)

Tab:Toggle("ä¿®æ”¹è·³è·ƒ", false, function(Value)
    if Value then
        EnableJump = game:GetService("RunService").RenderStepped:Connect(function()
            if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
                game.Players.LocalPlayer.Character.Humanoid.JumpPower = JumpPower or 30
            end
        end)
    else
        if EnableJump then
            EnableJump:Disconnect()
        end
        if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
            game.Players.LocalPlayer.Character.Humanoid.JumpPower = 30
        end
    end
end)

Tab:Slider("Speed", 0, 10, 0, function(Value)
    Speed = Value
end)

Tab:Slider("Jump Power", 30, 100, 0, function(Value)
    JumpPower = Value
end)

local Tab = Win:Tab("å…³é—­")

Tab:Button("å…³é—­è„šæœ¬(è¯·å…ˆå…³é—­åŠŸèƒ½)", function()
    game.CoreGui.VisionLibV2:Destroy()
    game.CoreGui.VisionLibOverlay:Destroy()
    if game:GetService("UserInputService").KeyboardEnabled and game:GetService("UserInputService").MouseEnabled then
        game.CoreGui.Vape:Destroy()
    elseif game:GetService("UserInputService").TouchEnabled then
        game.CoreGui.Open:Destroy()
        game.CoreGui.Vape:Destroy()
    end
end)
